<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./CSS/myReset.css">
    <title>JS 입력 삭제 출력</title>
</head>
<body>
    <!-- <form action="#" method="get" id="frmRecp"> -->
        <!-- form때문에 훅 넘어가기에 주석처리 -->
        <table>
            <tr>
                <th>구매자:</th>
                <td><input type="text" name="name" id="name" class="iv" placeholder="구매자 이름 입력"></td>
            </tr>
            <tr>
                <th>재료:</th>
                <td><input type="text" name="ingredient" id="ingredient" class="iv" placeholder="재료 입력"></td>
            </tr>
            <tr>
                <th>단가:</th>
                <td><input type="text" name="price" id="price" class="iv" placeholder="단가 입력"></td>
            </tr>
            <tr>
                <th>수량:</th>
                <td><input type="text" name="amount" id="amount" class="iv" placeholder="수량 입력"></td>
            </tr>
        </table>
        <button id="btnInsert" onclick="printValue();">입력</button>
        <!-- 괄호 & 세미콜론 반드시 -->
    <!-- </form> -->
    <div id="print"></div>
    <script>
        let eleCnt = 0;

        function printValue() {
            
            var inputEls = document.getElementsByClassName('iv');
            var name = inputEls[0].value;
            var ingredient = inputEls[1].value;
            var price = inputEls[2].value.trim();
            // value에서 띄어쓰기나 불필요한 공백 제거 혹은 사용자의 실수로 인해 발생한 공백제거
            var amount = inputEls[3].value.trim();

            // 입력할때마다 노드를 추가로 생성
            var divEle = document.createElement("p");
            eleCnt++;
            divEle.innerHTML = "";
            divEle.innerHTML = divEle.innerHTML + "구매자" + name + "님<br>";
            divEle.innerHTML += "구매 재료 : " + ingredient + "<br>";
            divEle.innerHTML += "단가 : " + price + "원<br>";
            divEle.innerHTML += "수량 : " + amount + "개<br>";
            divEle.innerHTML += "총가격 : " + (amount*price) + "원<br>";
            // 방법1
            divEle.innerHTML += '<button id="ele_'+eleCnt+'">삭제</button>';

            // 방법2
            // var btnEle = document.createElement("button");
            // btnEle.setAttribute("id", "ele_"+eleCnt);
            // btnEle.innerText = "삭제";
            // divEle.appendChild(btnEle);
            // 방법2 끝

            document.body.appendChild(divEle);

            // 불필요(this.parentElement 사용) --> divEle.setAttribute("class", "pele_"+(eleCnt));
            // ++eleCount --> jsp에서 많이 이용

            document.getElementsId("ele_"+eleCnt).onclick = function () {
                // 클릭 이벤트는 반드시 printValue 함수안에 있어야한다.
                // 그래야 위의 값들을 인식할 수 있다.

                // "ele_"+eleCnt 이것만하고 버튼외 다른 클래스를 선택해도 이벤트가 발생한다.
                // getElementsByClassName --> 얘는 무조건 배열형태로 반환(1개짜리 배열이여도 클릭이벤트를 등록할 수 없다.)
                // 이 문제를 해결하기위해 id를 이용한다. (class로는 클릭이벤트를 해결할 수없다.)

                // document.getElementById("ele_"+eleCnt).remove();
                // document.getElementById("ele_"+eleCnt) 이 문법도 안 된다.
                // why? 입력버튼을 눌르면 printValue함수로 진입한다.
                // p태그를 만든후 바로 삭제를 누르면  "ele_"+eleCnt가 동일하다.
                // 그러니 p태그를 만든후 계속해서 p태그를 만들면
                // "ele_"+eleCnt가 불일치하게 된다.

                // 그러나 this라는 개념을 알면 위와같이 할 필요가없다.
                this.parentElement.remove();
                // 나의 부모를 찾아가서 부모를 지운다.
                // this.parentElement = "pele_"+(eleCnt)
            }
        }
    </script>
</body>
</html>