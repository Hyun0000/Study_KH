<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>hw1</title>
    <script>
        window.addEventListener("load", pageLodedHandler);
        function pageLodedHandler() {
            // 이벤트 등록과 이벤트 함수 정의 모두 pageLodedHandler에 한다.
            // 이벤트 등록은 반드시 여기서 해야한다.
            // load 이벤트는 script 전체를 감싼다.

            // submit 버튼이 눌러지면 이벤트 등록
            // document.getElementById("submit").addEventListener("click", btnSubmit);
            document.getElementById("btn1").addEventListener("click", btnSubmit);
        }

        // common function
        function checkNullValue(n1) {
            if (n1.value.length == 0) {
                alert('입력해주세요');
                // 포커스 맞추기
                n1.focus();
                return false;
            } else {
                return true;
            }
        }

        // submit 클릭 관련 함수는 onload밖에서 정의하는 경우가 많다
        // 인라인 형태로 호출될 가능성이 있으니까
        // 어느 형태로 하든 정답은 없다.
        function btnSubmit() {
            // 버튼을 누른 시점에 진입한다.
            console.log("btnSubmit 진입");
            
            var pw1 = document.getElementById("pwd");
            var pw2 = document.getElementById("repwd");

            var pw1Value = pw1.value;
            var pw2Value = pw2.value;

            // 방법3 아래것도 귀찮다.
            var inputElements = document.getElementsByTagName('input');
            inputElements.forEach(function (n1){
                if (n1.value.length == 0) {
                alert('입력해주세요');
                n1.focus();
                return false;
            } else {
                return true;
            }
            });
            // 완벽히 끝내지 못함
            


            // 방법2 이것도 함수로 뺴버리자
            // var cnv = checkNullValue(document.getElementById('id'));
            // if (cnv == false) { return false; }

            // var cnv = checkNullValue(document.getElementById('pwd'));
            // if (cnv == false) { return false; }

            // var cnv = checkNullValue(document.getElementById('repwd'));
            // if (cnv == false) { return false; }

            // var cnv = checkNullValue(document.getElementById('name'));
            // if (cnv == false) { return false; }

            // 입력되지 않는 칸이 있는지 확인(위치가 중요)
            // 서브밋 함수 안에 있어도 되고 밖에 있어도 된다.
            // if (document.getElementById('id').value.length == 0) {
            //     alert('입력해주세요');
            //     // 포커스 맞추기
            //     document.getElementById('id').focus();
            //     return false;
            // }
            // if (document.getElementById('pwd').value.length == 0) {
            //     alert('입력해주세요');
            //     // 포커스 맞추기
            //     document.getElementById('pwd').focus();
            //     return false;
            // }

            // if (document.getElementById('repwd').value.length == 0) {
            //     alert('입력해주세요');
            //     // 포커스 맞추기
            //     document.getElementById('repwd').focus();
            //     return false;
            // }

            // if (document.getElementById('name').value.length == 0) {
            //     alert('입력해주세요');
            //     // 포커스 맞추기
            //     document.getElementById('name').focus();
            //     return false;
            // }
                

            // 경고 순서대로 위쪽에 작성
            // 비밀번호 첫글자는 대문자, 6글자이상, 12글자 이하 ==> 정상
            // 경고 팝업 "조건에 맞게 입력해주세여" & action으로 이동되지 않는다.
            // load가 아니라 submit 버튼이 눌러지면 수행되야한다.
            if (pw1Value.length < 6 || pw1Value.length > 12) {
                alert("조건에 맞게 입력해주세요");
                return false;
                /* action으로 이동하지 않게 한다. */
            }

            // 비밀번호와 비밀번호 확인란이 동일하지 않으면 alert 창으로 "동일하게 입력해주세요" & action으로 이동하지 않음
            if (pw1Value != pw2Value) {
                alert("동일하게 입력해주세요");
                return false;
                // 스크립트에서 false를 줘도 body의 서브밋은 동작한다.
                // 서브밋을 막을려면 인라인 방식을 써야한다.
                // 인라인 방식을 쓰지 않고 스크립트를 통해 action으로 가지 않게 만드는 방법은 없다.
                // 즉, 스크립트에서의 false는 스크립트내의 조건문끼리만 영향을 미칠수 있지
                // 서브밋 실행에는 영향을 미칠수 없다.
                // 그래서 이 함수를 pageLodedHandler 밖으로 빼놓은 것이다.
                // 인라인 형태로 호출될 가능성이 높으니까

                // 순서
                // 1 클릭 이벤트 등록 함수 수행
                // 2 리콰이얼드
                // 3 서브밋기능(action)으로 이동
            }

            // 그 외는 action으로 데이터 전달하면서 이동된다.  
            {
                var frm1 = document.getElementById('frmId1');

                // 이렇게 이용할수도 있다.
                if (document.getElementById('id').value == 'admin') {
                    frm1.action = '#관리자페이지'
                } else {
                    frm1.action = '#일반페이지'
                }
                frm1.method = 'post';
                frm1.submit();
                // action 위치로 서브밋 되게 해주라
                // return true;
            }
          } 
    </script>

</head>

<body>
    <!-- <form action="#" method="get" id="frmIdi"> -->
    <!-- 액션, 메소드를 작성하지 않아도 된다. by var frm1 = document.getElementById('frmId1'); -->
    <form id="frmId1">
        <fieldset>
            <legend>회원가입</legend>
            <label for="id">아이디 : </label>
            <input type="text" id="id" name="id" required>
            <span id="checkid"></span>
            <br><br>
            <label for="pwd">비밀번호 : </label>
            <input type="password" id="pwd" name="pwd" required>
            <br><br>
            <label for="repwd">비밀번호 확인 : </label>
            <input type="password" id="repwd" required>
            <!-- action으로 전달하지 않을거면 name 설정안해도 된다. -->
            <!-- <input type="password" id="repwd" name="pwd" required> -->
            <span id="checkpwd"></span>
            <br><br>
            <label for="name">이름 : </label>
            <input type="text" id="name" name="name" required>
            <br><br>
            <!-- <button type="submit" id="submit">회원가입<button> 해결 불가-->

            <!-- 이렇게 하면 required가 안 먹힌다. -->
            <!-- <button type="submit" id="submit" onclick="return btnSubmit();">회원가입</button> -->

            <!-- 해결방법 -->
            <button type="button" id="btn1">버튼타입 제출</button>
            <!-- 서브밋 기능이 없는 일반 버튼을 만든 후  -->


            <!-- 여기서는 btnSubmit을 인라인 방식으로 쓸 수 없다.
            why? btnSubmit 함수가 현재 pageLodedHandler의 지역함수로 속해있기 때문 -->

            <!-- submit의 온클릭관련 함수가  input의 required보다 먼저 발동하고 있다.
            방법
            required를 인풋에서 체크하지 않고
            스크립트에서 체크한다.

            return btnSubmit(); -- 이 방식을 통해서만 서브밋 기능을 막을수있다

            false이면 submit을 못하게 막는다.
            따라서 서브밋은 반드시 인라인 이벤트 형식을 써야한다.
            -->
        </fieldset>
        <!-- 비밀번호와 비밀번호 확인을 둘 다 전달할 필요없다. -->
    </form>
</body>
</html>